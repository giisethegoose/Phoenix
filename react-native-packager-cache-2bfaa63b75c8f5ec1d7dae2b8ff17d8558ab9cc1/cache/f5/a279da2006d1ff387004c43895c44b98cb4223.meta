["493b6889c56b3a782e199035312f75df2fd0173f","7e42922c4b93998ade7be154e2a8568ab8807603",["./implementation/args","./implementation/blob","./implementation/error","./implementation/location","./implementation/metadata","./implementation/object","./implementation/path","./implementation/requests","./implementation/string","./implementation/type","./task"],[98,145,199,251,304,355,402,451,505,556,603,650],{"version":3,"sources":["/home/giise/candidtwo/node_modules/@firebase/storage/dist/cjs/src/reference.js"],"names":["Object","defineProperty","exports","value","args","require","blob_1","errorsExports","location_1","metadata","object","path","requests","fbsString","string_1","type","task_1","Reference","authWrapper","location","Location","makeFromUrl","prototype","toString","validate","arguments","bucket","newRef","mappings","getMappings","child","childPath","stringSpec","newPath","get","parent","enumerable","configurable","lastComponent","service","put","data","uploadDataSpec","metadataSpec","throwIfRoot_","UploadTask","FbsBlob","putString","string","format","opt_metadata","StringFormat","RAW","formatValidator","dataFromString","clone","isDef","contentType","delete","self","getAuthToken","then","authToken","requestInfo","deleteObject","makeRequest","getPromise","getMetadata","updateMetadata","getDownloadURL","url","noDownloadURL","name","invalidRootOperation"],"mappings":"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","sourcesContent":["\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @fileoverview Defines the Firebase Storage Reference class.\n */\nvar args = require(\"./implementation/args\");\nvar blob_1 = require(\"./implementation/blob\");\nvar errorsExports = require(\"./implementation/error\");\nvar location_1 = require(\"./implementation/location\");\nvar metadata = require(\"./implementation/metadata\");\nvar object = require(\"./implementation/object\");\nvar path = require(\"./implementation/path\");\nvar requests = require(\"./implementation/requests\");\nvar fbsString = require(\"./implementation/string\");\nvar string_1 = require(\"./implementation/string\");\nvar type = require(\"./implementation/type\");\nvar task_1 = require(\"./task\");\n/**\n * Provides methods to interact with a bucket in the Firebase Storage service.\n * @param location An fbs.location, or the URL at\n *     which to base this object, in one of the following forms:\n *         gs://<bucket>/<object-path>\n *         http[s]://firebasestorage.googleapis.com/\n *                     <api-version>/b/<bucket>/o/<object-path>\n *     Any query or fragment strings will be ignored in the http[s]\n *     format. If no value is passed, the storage object will use a URL based on\n *     the project ID of the base firebase.App instance.\n */\nvar Reference = /** @class */ (function () {\n    function Reference(authWrapper, location) {\n        this.authWrapper = authWrapper;\n        if (location instanceof location_1.Location) {\n            this.location = location;\n        }\n        else {\n            this.location = location_1.Location.makeFromUrl(location);\n        }\n    }\n    /**\n     * @return The URL for the bucket and path this object references,\n     *     in the form gs://<bucket>/<object-path>\n     * @override\n     */\n    Reference.prototype.toString = function () {\n        args.validate('toString', [], arguments);\n        return 'gs://' + this.location.bucket + '/' + this.location.path;\n    };\n    Reference.prototype.newRef = function (authWrapper, location) {\n        return new Reference(authWrapper, location);\n    };\n    Reference.prototype.mappings = function () {\n        return metadata.getMappings();\n    };\n    /**\n     * @return A reference to the object obtained by\n     *     appending childPath, removing any duplicate, beginning, or trailing\n     *     slashes.\n     */\n    Reference.prototype.child = function (childPath) {\n        args.validate('child', [args.stringSpec()], arguments);\n        var newPath = path.child(this.location.path, childPath);\n        var location = new location_1.Location(this.location.bucket, newPath);\n        return this.newRef(this.authWrapper, location);\n    };\n    Object.defineProperty(Reference.prototype, \"parent\", {\n        /**\n         * @return A reference to the parent of the\n         *     current object, or null if the current object is the root.\n         */\n        get: function () {\n            var newPath = path.parent(this.location.path);\n            if (newPath === null) {\n                return null;\n            }\n            var location = new location_1.Location(this.location.bucket, newPath);\n            return this.newRef(this.authWrapper, location);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Reference.prototype, \"root\", {\n        /**\n         * @return An reference to the root of this\n         *     object's bucket.\n         */\n        get: function () {\n            var location = new location_1.Location(this.location.bucket, '');\n            return this.newRef(this.authWrapper, location);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Reference.prototype, \"bucket\", {\n        get: function () {\n            return this.location.bucket;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Reference.prototype, \"fullPath\", {\n        get: function () {\n            return this.location.path;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Reference.prototype, \"name\", {\n        get: function () {\n            return path.lastComponent(this.location.path);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Reference.prototype, \"storage\", {\n        get: function () {\n            return this.authWrapper.service();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Uploads a blob to this object's location.\n     * @param data The blob to upload.\n     * @return An UploadTask that lets you control and\n     *     observe the upload.\n     */\n    Reference.prototype.put = function (data, metadata) {\n        if (metadata === void 0) { metadata = null; }\n        args.validate('put', [args.uploadDataSpec(), args.metadataSpec(true)], arguments);\n        this.throwIfRoot_('put');\n        return new task_1.UploadTask(this, this.authWrapper, this.location, this.mappings(), new blob_1.FbsBlob(data), metadata);\n    };\n    /**\n     * Uploads a string to this object's location.\n     * @param string The string to upload.\n     * @param opt_format The format of the string to upload.\n     * @return An UploadTask that lets you control and\n     *     observe the upload.\n     */\n    Reference.prototype.putString = function (string, format, opt_metadata) {\n        if (format === void 0) { format = string_1.StringFormat.RAW; }\n        args.validate('putString', [\n            args.stringSpec(),\n            args.stringSpec(fbsString.formatValidator, true),\n            args.metadataSpec(true)\n        ], arguments);\n        this.throwIfRoot_('putString');\n        var data = fbsString.dataFromString(format, string);\n        var metadata = object.clone(opt_metadata);\n        if (!type.isDef(metadata['contentType']) && type.isDef(data.contentType)) {\n            metadata['contentType'] = data.contentType;\n        }\n        return new task_1.UploadTask(this, this.authWrapper, this.location, this.mappings(), new blob_1.FbsBlob(data.data, true), metadata);\n    };\n    /**\n     * Deletes the object at this location.\n     * @return A promise that resolves if the deletion succeeds.\n     */\n    Reference.prototype.delete = function () {\n        args.validate('delete', [], arguments);\n        this.throwIfRoot_('delete');\n        var self = this;\n        return this.authWrapper.getAuthToken().then(function (authToken) {\n            var requestInfo = requests.deleteObject(self.authWrapper, self.location);\n            return self.authWrapper.makeRequest(requestInfo, authToken).getPromise();\n        });\n    };\n    /**\n     *     A promise that resolves with the metadata for this object. If this\n     *     object doesn't exist or metadata cannot be retreived, the promise is\n     *     rejected.\n     */\n    Reference.prototype.getMetadata = function () {\n        args.validate('getMetadata', [], arguments);\n        this.throwIfRoot_('getMetadata');\n        var self = this;\n        return this.authWrapper.getAuthToken().then(function (authToken) {\n            var requestInfo = requests.getMetadata(self.authWrapper, self.location, self.mappings());\n            return self.authWrapper.makeRequest(requestInfo, authToken).getPromise();\n        });\n    };\n    /**\n     * Updates the metadata for this object.\n     * @param metadata The new metadata for the object.\n     *     Only values that have been explicitly set will be changed. Explicitly\n     *     setting a value to null will remove the metadata.\n     * @return A promise that resolves\n     *     with the new metadata for this object.\n     *     @see firebaseStorage.Reference.prototype.getMetadata\n     */\n    Reference.prototype.updateMetadata = function (metadata) {\n        args.validate('updateMetadata', [args.metadataSpec()], arguments);\n        this.throwIfRoot_('updateMetadata');\n        var self = this;\n        return this.authWrapper.getAuthToken().then(function (authToken) {\n            var requestInfo = requests.updateMetadata(self.authWrapper, self.location, metadata, self.mappings());\n            return self.authWrapper.makeRequest(requestInfo, authToken).getPromise();\n        });\n    };\n    /**\n     * @return A promise that resolves with the download\n     *     URL for this object.\n     */\n    Reference.prototype.getDownloadURL = function () {\n        args.validate('getDownloadURL', [], arguments);\n        this.throwIfRoot_('getDownloadURL');\n        return this.getMetadata().then(function (metadata) {\n            var url = metadata['downloadURLs'][0];\n            if (type.isDef(url)) {\n                return url;\n            }\n            else {\n                throw errorsExports.noDownloadURL();\n            }\n        });\n    };\n    Reference.prototype.throwIfRoot_ = function (name) {\n        if (this.location.path === '') {\n            throw errorsExports.invalidRootOperation(name);\n        }\n    };\n    return Reference;\n}());\nexports.Reference = Reference;\n\n//# sourceMappingURL=reference.js.map\n"]}]