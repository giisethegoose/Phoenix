["81b0ea6485c45180b5bec70a836e749a4ef4bac2","2bcab379502109e091df71ab5b2c745d7f971f96",["./ChildrenNode","./LeafNode","./Node","@firebase/util","./childSet","./comparators","./IndexMap","./indexes/PriorityIndex"],[107,151,187,219,259,303,346,389,434],{"version":3,"sources":["/home/giise/candidtwo/node_modules/@firebase/database/dist/cjs/src/core/snap/nodeFromJSON.js"],"names":["Object","defineProperty","exports","value","ChildrenNode_1","require","LeafNode_1","Node_1","util_1","util_2","childSet_1","comparators_1","IndexMap_1","PriorityIndex_1","USE_HINZE","nodeFromJSON","json","priority","ChildrenNode","EMPTY_NODE","assert","jsonLeaf","LeafNode","Array","children_1","childrenHavePriority_1","hinzeJsonObj_1","forEach","key","child","substring","childNode","isEmpty","getPriority","push","NamedNode","length","childSet","buildChildSet","NAME_ONLY_COMPARATOR","namedNode","name","NAME_COMPARATOR","sortedChildSet","PRIORITY_INDEX","getCompare","IndexMap","Default","node_1","jsonObj_1","childData","contains","isLeafNode","updateImmediateChild","updatePriority","setNodeFromJSON"],"mappings":"AAAA;;AAgBAA,OAAOC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C,EAAEC,OAAO,IAAT,EAA7C;AACA,IAAIC,iBAAiBC,QAAQ,gBAAR,CAArB;AACA,IAAIC,aAAaD,QAAQ,YAAR,CAAjB;AACA,IAAIE,SAASF,QAAQ,QAAR,CAAb;AACA,IAAIG,SAASH,OAAT,kBAAJ;AACA,IAAII,SAASJ,OAAT,kBAAJ;AACA,IAAIK,aAAaL,QAAQ,YAAR,CAAjB;AACA,IAAIM,gBAAgBN,QAAQ,eAAR,CAApB;AACA,IAAIO,aAAaP,QAAQ,YAAR,CAAjB;AACA,IAAIQ,kBAAkBR,QAAQ,yBAAR,CAAtB;AACA,IAAIS,YAAY,IAAhB;;AAQA,SAASC,YAAT,CAAsBC,IAAtB,EAA4BC,QAA5B,EAAsC;AAClC,QAAIA,aAAa,KAAK,CAAtB,EAAyB;AAAEA,mBAAW,IAAX;AAAkB;AAC7C,QAAID,SAAS,IAAb,EAAmB;AACf,eAAOZ,eAAec,YAAf,CAA4BC,UAAnC;AACH;AACD,QAAI,OAAOH,IAAP,KAAgB,QAAhB,IAA4B,eAAeA,IAA/C,EAAqD;AACjDC,mBAAWD,KAAK,WAAL,CAAX;AACH;AACDP,WAAOW,MAAP,CAAcH,aAAa,IAAb,IACV,OAAOA,QAAP,KAAoB,QADV,IAEV,OAAOA,QAAP,KAAoB,QAFV,IAGT,OAAOA,QAAP,KAAoB,QAApB,IAAgC,SAASA,QAH9C,EAGyD,kCAAkC,OAAOA,QAHlG;AAIA,QAAI,OAAOD,IAAP,KAAgB,QAAhB,IAA4B,YAAYA,IAAxC,IAAgDA,KAAK,QAAL,MAAmB,IAAvE,EAA6E;AACzEA,eAAOA,KAAK,QAAL,CAAP;AACH;;AAED,QAAI,OAAOA,IAAP,KAAgB,QAAhB,IAA4B,SAASA,IAAzC,EAA+C;AAC3C,YAAIK,WAAWL,IAAf;AACA,eAAO,IAAIV,WAAWgB,QAAf,CAAwBD,QAAxB,EAAkCN,aAAaE,QAAb,CAAlC,CAAP;AACH;AACD,QAAI,EAAED,gBAAgBO,KAAlB,KAA4BT,SAAhC,EAA2C;AACvC,YAAIU,aAAa,EAAjB;AACA,YAAIC,yBAAyB,KAA7B;AACA,YAAIC,iBAAiBV,IAArB;AACAR,eAAOmB,OAAP,CAAeD,cAAf,EAA+B,UAAUE,GAAV,EAAeC,KAAf,EAAsB;AACjD,gBAAI,OAAOD,GAAP,KAAe,QAAf,IAA2BA,IAAIE,SAAJ,CAAc,CAAd,EAAiB,CAAjB,MAAwB,GAAvD,EAA4D;AAExD,oBAAIC,YAAYhB,aAAaW,eAAeE,GAAf,CAAb,CAAhB;AACA,oBAAI,CAACG,UAAUC,OAAV,EAAL,EAA0B;AACtBP,6CACIA,0BAA0B,CAACM,UAAUE,WAAV,GAAwBD,OAAxB,EAD/B;AAEAR,+BAAWU,IAAX,CAAgB,IAAI3B,OAAO4B,SAAX,CAAqBP,GAArB,EAA0BG,SAA1B,CAAhB;AACH;AACJ;AACJ,SAVD;AAWA,YAAIP,WAAWY,MAAX,IAAqB,CAAzB,EAA4B;AACxB,mBAAOhC,eAAec,YAAf,CAA4BC,UAAnC;AACH;AACD,YAAIkB,WAAW3B,WAAW4B,aAAX,CAAyBd,UAAzB,EAAqCb,cAAc4B,oBAAnD,EAAyE,UAAUC,SAAV,EAAqB;AAAE,mBAAOA,UAAUC,IAAjB;AAAwB,SAAxH,EAA0H9B,cAAc+B,eAAxI,CAAf;AACA,YAAIjB,sBAAJ,EAA4B;AACxB,gBAAIkB,iBAAiBjC,WAAW4B,aAAX,CAAyBd,UAAzB,EAAqCX,gBAAgB+B,cAAhB,CAA+BC,UAA/B,EAArC,CAArB;AACA,mBAAO,IAAIzC,eAAec,YAAnB,CAAgCmB,QAAhC,EAA0CtB,aAAaE,QAAb,CAA1C,EAAkE,IAAIL,WAAWkC,QAAf,CAAwB,EAAE,aAAaH,cAAf,EAAxB,EAAyD,EAAE,aAAa9B,gBAAgB+B,cAA/B,EAAzD,CAAlE,CAAP;AACH,SAHD,MAIK;AACD,mBAAO,IAAIxC,eAAec,YAAnB,CAAgCmB,QAAhC,EAA0CtB,aAAaE,QAAb,CAA1C,EAAkEL,WAAWkC,QAAX,CAAoBC,OAAtF,CAAP;AACH;AACJ,KA1BD,MA2BK;AACD,YAAIC,SAAS5C,eAAec,YAAf,CAA4BC,UAAzC;AACA,YAAI8B,YAAYjC,IAAhB;AACAR,eAAOmB,OAAP,CAAesB,SAAf,EAA0B,UAAUrB,GAAV,EAAesB,SAAf,EAA0B;AAChD,gBAAI1C,OAAO2C,QAAP,CAAgBF,SAAhB,EAA2BrB,GAA3B,CAAJ,EAAqC;AACjC,oBAAIA,IAAIE,SAAJ,CAAc,CAAd,EAAiB,CAAjB,MAAwB,GAA5B,EAAiC;AAE7B,wBAAIC,YAAYhB,aAAamC,SAAb,CAAhB;AACA,wBAAInB,UAAUqB,UAAV,MAA0B,CAACrB,UAAUC,OAAV,EAA/B,EACIgB,SAASA,OAAOK,oBAAP,CAA4BzB,GAA5B,EAAiCG,SAAjC,CAAT;AACP;AACJ;AACJ,SATD;AAUA,eAAOiB,OAAOM,cAAP,CAAsBvC,aAAaE,QAAb,CAAtB,CAAP;AACH;AACJ;AACDf,QAAQa,YAAR,GAAuBA,YAAvB;AACAF,gBAAgB0C,eAAhB,CAAgCxC,YAAhC","sourcesContent":["\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ChildrenNode_1 = require(\"./ChildrenNode\");\nvar LeafNode_1 = require(\"./LeafNode\");\nvar Node_1 = require(\"./Node\");\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"@firebase/util\");\nvar childSet_1 = require(\"./childSet\");\nvar comparators_1 = require(\"./comparators\");\nvar IndexMap_1 = require(\"./IndexMap\");\nvar PriorityIndex_1 = require(\"./indexes/PriorityIndex\");\nvar USE_HINZE = true;\n/**\n * Constructs a snapshot node representing the passed JSON and returns it.\n * @param {*} json JSON to create a node for.\n * @param {?string|?number=} priority Optional priority to use.  This will be ignored if the\n * passed JSON contains a .priority property.\n * @return {!Node}\n */\nfunction nodeFromJSON(json, priority) {\n    if (priority === void 0) { priority = null; }\n    if (json === null) {\n        return ChildrenNode_1.ChildrenNode.EMPTY_NODE;\n    }\n    if (typeof json === 'object' && '.priority' in json) {\n        priority = json['.priority'];\n    }\n    util_2.assert(priority === null ||\n        typeof priority === 'string' ||\n        typeof priority === 'number' ||\n        (typeof priority === 'object' && '.sv' in priority), 'Invalid priority type found: ' + typeof priority);\n    if (typeof json === 'object' && '.value' in json && json['.value'] !== null) {\n        json = json['.value'];\n    }\n    // Valid leaf nodes include non-objects or server-value wrapper objects\n    if (typeof json !== 'object' || '.sv' in json) {\n        var jsonLeaf = json;\n        return new LeafNode_1.LeafNode(jsonLeaf, nodeFromJSON(priority));\n    }\n    if (!(json instanceof Array) && USE_HINZE) {\n        var children_1 = [];\n        var childrenHavePriority_1 = false;\n        var hinzeJsonObj_1 = json;\n        util_1.forEach(hinzeJsonObj_1, function (key, child) {\n            if (typeof key !== 'string' || key.substring(0, 1) !== '.') {\n                // Ignore metadata nodes\n                var childNode = nodeFromJSON(hinzeJsonObj_1[key]);\n                if (!childNode.isEmpty()) {\n                    childrenHavePriority_1 =\n                        childrenHavePriority_1 || !childNode.getPriority().isEmpty();\n                    children_1.push(new Node_1.NamedNode(key, childNode));\n                }\n            }\n        });\n        if (children_1.length == 0) {\n            return ChildrenNode_1.ChildrenNode.EMPTY_NODE;\n        }\n        var childSet = childSet_1.buildChildSet(children_1, comparators_1.NAME_ONLY_COMPARATOR, function (namedNode) { return namedNode.name; }, comparators_1.NAME_COMPARATOR);\n        if (childrenHavePriority_1) {\n            var sortedChildSet = childSet_1.buildChildSet(children_1, PriorityIndex_1.PRIORITY_INDEX.getCompare());\n            return new ChildrenNode_1.ChildrenNode(childSet, nodeFromJSON(priority), new IndexMap_1.IndexMap({ '.priority': sortedChildSet }, { '.priority': PriorityIndex_1.PRIORITY_INDEX }));\n        }\n        else {\n            return new ChildrenNode_1.ChildrenNode(childSet, nodeFromJSON(priority), IndexMap_1.IndexMap.Default);\n        }\n    }\n    else {\n        var node_1 = ChildrenNode_1.ChildrenNode.EMPTY_NODE;\n        var jsonObj_1 = json;\n        util_1.forEach(jsonObj_1, function (key, childData) {\n            if (util_1.contains(jsonObj_1, key)) {\n                if (key.substring(0, 1) !== '.') {\n                    // ignore metadata nodes.\n                    var childNode = nodeFromJSON(childData);\n                    if (childNode.isLeafNode() || !childNode.isEmpty())\n                        node_1 = node_1.updateImmediateChild(key, childNode);\n                }\n            }\n        });\n        return node_1.updatePriority(nodeFromJSON(priority));\n    }\n}\nexports.nodeFromJSON = nodeFromJSON;\nPriorityIndex_1.setNodeFromJSON(nodeFromJSON);\n\n//# sourceMappingURL=nodeFromJSON.js.map\n"]}]