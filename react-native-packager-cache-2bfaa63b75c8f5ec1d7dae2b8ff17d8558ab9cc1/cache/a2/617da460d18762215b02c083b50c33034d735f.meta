["de9cca87b0752065ef865f8eca0c3b254b6ab285","3555467338a3383cbc46d222e3d6ce708c34c999",["react-native","../utils/uuid"],[122,160],{"version":3,"sources":["/home/giise/candidtwo/node_modules/react-native-fetch-blob/class/RNFetchBlobReadStream.js"],"names":["RNFetchBlob","emitter","RNFetchBlobReadStream","path","encoding","bufferSize","tick","Error","closed","_onData","_onEnd","_onError","streamId","subscription","addListener","e","event","detail","remove","readStream","fn"],"mappings":";;;;;AAIA;;AAKA;;;;AAEA,IAAMA,cAAc,2BAAcA,WAAlC;AACA,IAAMC,yCAAN;;IAEqBC,qB;AAQnB,iCAAYC,IAAZ,EAAyBC,QAAzB,EAA0CC,UAA1C,EAA+DC,IAA/D,EAA4E;AAAA;;AAAA;AAAA,SAF5EA,IAE4E,GAF5D,EAE4D;;AAC1E,QAAG,CAACH,IAAJ,EACE,MAAMI,MAAM,0DAAN,CAAN;AACF,SAAKH,QAAL,GAAgBA,YAAY,MAA5B;AACA,SAAKC,UAAL,GAAkBA,UAAlB;AACA,SAAKF,IAAL,GAAYA,IAAZ;AACA,SAAKK,MAAL,GAAc,KAAd;AACA,SAAKF,IAAL,GAAYA,IAAZ;AACA,SAAKG,OAAL,GAAe,YAAM,CAAE,CAAvB;AACA,SAAKC,MAAL,GAAc,YAAM,CAAE,CAAtB;AACA,SAAKC,QAAL,GAAgB,YAAM,CAAE,CAAxB;AACA,SAAKC,QAAL,GAAgB,WAAU,qBAA1B;;AAGA,QAAIC,eAAeZ,QAAQa,WAAR,CAAoB,KAAKF,QAAzB,EAAmC,UAACG,CAAD,EAAO;AAAA,UACtDC,KADsD,GACrCD,CADqC,CACtDC,KADsD;AAAA,UAC/CC,MAD+C,GACrCF,CADqC,CAC/CE,MAD+C;;AAE3D,UAAG,MAAKR,OAAL,IAAgBO,UAAU,MAA7B,EAAqC;AACnC,cAAKP,OAAL,CAAaQ,MAAb;AACA;AACD,OAHD,MAIK,IAAI,MAAKP,MAAL,IAAeM,UAAU,KAA7B,EAAoC;AACvC,cAAKN,MAAL,CAAYO,MAAZ;AACD,OAFI,MAGA;AACH,YAAG,MAAKN,QAAR,EACE,MAAKA,QAAL,CAAcM,MAAd,EADF,KAGE,MAAM,IAAIV,KAAJ,CAAUU,MAAV,CAAN;AACH;;AAED,UAAID,UAAU,OAAV,IAAqBA,UAAU,KAAnC,EAA0C;AACxCH,qBAAaK,MAAb;AACA,cAAKV,MAAL,GAAc,IAAd;AACD;AACF,KApBkB,CAAnB;AAsBD;;;;2BAEM;AACL,UAAG,CAAC,KAAKA,MAAT,EACER,YAAYmB,UAAZ,CAAuB,KAAKhB,IAA5B,EAAkC,KAAKC,QAAvC,EAAiD,KAAKC,UAAL,IAAmB,KAApE,EAA4E,KAAKC,IAAL,IAAa,CAAC,CAA1F,EAA6F,KAAKM,QAAlG,EADF,KAGE,MAAM,IAAIL,KAAJ,CAAU,eAAV,CAAN;AACH;;;2BAEMa,E,EAAe;AACpB,WAAKX,OAAL,GAAeW,EAAf;AACD;;;4BAEOA,E,EAAI;AACV,WAAKT,QAAL,GAAgBS,EAAhB;AACD;;;0BAEMA,E,EAAI;AACT,WAAKV,MAAL,GAAcU,EAAd;AACD;;;;;kBA/DkBlB,qB","sourcesContent":["// Copyright 2016 wkh237@github. All rights reserved.\n// Use of this source code is governed by a MIT-style license that can be\n// found in the LICENSE file.\n\nimport {\n  NativeModules,\n  DeviceEventEmitter,\n  NativeAppEventEmitter,\n} from 'react-native'\nimport UUID from '../utils/uuid'\n\nconst RNFetchBlob = NativeModules.RNFetchBlob\nconst emitter = DeviceEventEmitter\n\nexport default class RNFetchBlobReadStream {\n\n  path : string;\n  encoding : 'utf8' | 'ascii' | 'base64';\n  bufferSize : ?number;\n  closed : boolean;\n  tick : number = 10;\n\n  constructor(path:string, encoding:string, bufferSize?:?number, tick:number) {\n    if(!path)\n      throw Error('RNFetchBlob could not open file stream with empty `path`')\n    this.encoding = encoding || 'utf8'\n    this.bufferSize = bufferSize\n    this.path = path\n    this.closed = false\n    this.tick = tick\n    this._onData = () => {}\n    this._onEnd = () => {}\n    this._onError = () => {}\n    this.streamId = 'RNFBRS'+ UUID()\n\n    // register for file stream event\n    let subscription = emitter.addListener(this.streamId, (e) => {\n      let {event, detail} = e\n      if(this._onData && event === 'data') {\n        this._onData(detail)\n        return\n      }\n      else if (this._onEnd && event === 'end') {\n        this._onEnd(detail)\n      }\n      else {\n        if(this._onError)\n          this._onError(detail)\n        else\n          throw new Error(detail)\n      }\n      // when stream closed or error, remove event handler\n      if (event === 'error' || event === 'end') {\n        subscription.remove()\n        this.closed = true\n      }\n    })\n\n  }\n\n  open() {\n    if(!this.closed)\n      RNFetchBlob.readStream(this.path, this.encoding, this.bufferSize || 10240 , this.tick || -1, this.streamId)\n    else\n      throw new Error('Stream closed')\n  }\n\n  onData(fn:() => void) {\n    this._onData = fn\n  }\n\n  onError(fn) {\n    this._onError = fn\n  }\n\n  onEnd (fn) {\n    this._onEnd = fn\n  }\n\n}\n"]}]