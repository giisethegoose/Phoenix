["6dfdc724e7eb0ee5e40085866273e1561f634d79","fbe07b1c22fed3231c3efa8f0a39065243ade20a",["../../api/DataSnapshot","./Event","@firebase/util"],[107,156,189,229],{"version":3,"sources":["/home/giise/candidtwo/node_modules/@firebase/database/dist/cjs/src/core/view/EventRegistration.js"],"names":["Object","defineProperty","exports","value","DataSnapshot_1","require","Event_1","util_1","util_2","ValueEventRegistration","callback_","cancelCallback_","context_","prototype","respondsTo","eventType","createEvent","change","query","index","getQueryParams","getIndex","DataEvent","DataSnapshot","snapshotNode","getRef","getEventRunner","eventData","ctx","getEventType","assert","cancelCB_1","call","error","cb_1","snapshot","createCancelEvent","path","CancelEvent","matches","other","hasAnyCallback","ChildEventRegistration","callbacks_","eventToCheck","contains","childName","ref","child","type","prevName","cancelCB_2","cb_2","otherCount","getCount","thisCount","otherKey","getAnyKey","thisKey","every","cb"],"mappings":"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","sourcesContent":["\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar DataSnapshot_1 = require(\"../../api/DataSnapshot\");\nvar Event_1 = require(\"./Event\");\nvar util_1 = require(\"@firebase/util\");\nvar util_2 = require(\"@firebase/util\");\n/**\n * Represents registration for 'value' events.\n */\nvar ValueEventRegistration = /** @class */ (function () {\n    /**\n     * @param {?function(!DataSnapshot)} callback_\n     * @param {?function(Error)} cancelCallback_\n     * @param {?Object} context_\n     */\n    function ValueEventRegistration(callback_, cancelCallback_, context_) {\n        this.callback_ = callback_;\n        this.cancelCallback_ = cancelCallback_;\n        this.context_ = context_;\n    }\n    /**\n     * @inheritDoc\n     */\n    ValueEventRegistration.prototype.respondsTo = function (eventType) {\n        return eventType === 'value';\n    };\n    /**\n     * @inheritDoc\n     */\n    ValueEventRegistration.prototype.createEvent = function (change, query) {\n        var index = query.getQueryParams().getIndex();\n        return new Event_1.DataEvent('value', this, new DataSnapshot_1.DataSnapshot(change.snapshotNode, query.getRef(), index));\n    };\n    /**\n     * @inheritDoc\n     */\n    ValueEventRegistration.prototype.getEventRunner = function (eventData) {\n        var ctx = this.context_;\n        if (eventData.getEventType() === 'cancel') {\n            util_2.assert(this.cancelCallback_, 'Raising a cancel event on a listener with no cancel callback');\n            var cancelCB_1 = this.cancelCallback_;\n            return function () {\n                // We know that error exists, we checked above that this is a cancel event\n                cancelCB_1.call(ctx, eventData.error);\n            };\n        }\n        else {\n            var cb_1 = this.callback_;\n            return function () {\n                cb_1.call(ctx, eventData.snapshot);\n            };\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    ValueEventRegistration.prototype.createCancelEvent = function (error, path) {\n        if (this.cancelCallback_) {\n            return new Event_1.CancelEvent(this, error, path);\n        }\n        else {\n            return null;\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    ValueEventRegistration.prototype.matches = function (other) {\n        if (!(other instanceof ValueEventRegistration)) {\n            return false;\n        }\n        else if (!other.callback_ || !this.callback_) {\n            // If no callback specified, we consider it to match any callback.\n            return true;\n        }\n        else {\n            return (other.callback_ === this.callback_ && other.context_ === this.context_);\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    ValueEventRegistration.prototype.hasAnyCallback = function () {\n        return this.callback_ !== null;\n    };\n    return ValueEventRegistration;\n}());\nexports.ValueEventRegistration = ValueEventRegistration;\n/**\n * Represents the registration of 1 or more child_xxx events.\n *\n * Currently, it is always exactly 1 child_xxx event, but the idea is we might let you\n * register a group of callbacks together in the future.\n *\n * @constructor\n * @implements {EventRegistration}\n */\nvar ChildEventRegistration = /** @class */ (function () {\n    /**\n     * @param {?Object.<string, function(!DataSnapshot, ?string=)>} callbacks_\n     * @param {?function(Error)} cancelCallback_\n     * @param {Object=} context_\n     */\n    function ChildEventRegistration(callbacks_, cancelCallback_, context_) {\n        this.callbacks_ = callbacks_;\n        this.cancelCallback_ = cancelCallback_;\n        this.context_ = context_;\n    }\n    /**\n     * @inheritDoc\n     */\n    ChildEventRegistration.prototype.respondsTo = function (eventType) {\n        var eventToCheck = eventType === 'children_added' ? 'child_added' : eventType;\n        eventToCheck =\n            eventToCheck === 'children_removed' ? 'child_removed' : eventToCheck;\n        return util_1.contains(this.callbacks_, eventToCheck);\n    };\n    /**\n     * @inheritDoc\n     */\n    ChildEventRegistration.prototype.createCancelEvent = function (error, path) {\n        if (this.cancelCallback_) {\n            return new Event_1.CancelEvent(this, error, path);\n        }\n        else {\n            return null;\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    ChildEventRegistration.prototype.createEvent = function (change, query) {\n        util_2.assert(change.childName != null, 'Child events should have a childName.');\n        var ref = query.getRef().child(/** @type {!string} */ (change.childName));\n        var index = query.getQueryParams().getIndex();\n        return new Event_1.DataEvent(change.type, this, new DataSnapshot_1.DataSnapshot(change.snapshotNode, ref, index), change.prevName);\n    };\n    /**\n     * @inheritDoc\n     */\n    ChildEventRegistration.prototype.getEventRunner = function (eventData) {\n        var ctx = this.context_;\n        if (eventData.getEventType() === 'cancel') {\n            util_2.assert(this.cancelCallback_, 'Raising a cancel event on a listener with no cancel callback');\n            var cancelCB_2 = this.cancelCallback_;\n            return function () {\n                // We know that error exists, we checked above that this is a cancel event\n                cancelCB_2.call(ctx, eventData.error);\n            };\n        }\n        else {\n            var cb_2 = this.callbacks_[eventData.eventType];\n            return function () {\n                cb_2.call(ctx, eventData.snapshot, eventData.prevName);\n            };\n        }\n    };\n    /**\n     * @inheritDoc\n     */\n    ChildEventRegistration.prototype.matches = function (other) {\n        if (other instanceof ChildEventRegistration) {\n            if (!this.callbacks_ || !other.callbacks_) {\n                return true;\n            }\n            else if (this.context_ === other.context_) {\n                var otherCount = util_1.getCount(other.callbacks_);\n                var thisCount = util_1.getCount(this.callbacks_);\n                if (otherCount === thisCount) {\n                    // If count is 1, do an exact match on eventType, if either is defined but null, it's a match.\n                    //  If event types don't match, not a match\n                    // If count is not 1, exact match across all\n                    if (otherCount === 1) {\n                        var otherKey /** @type {!string} */ = util_1.getAnyKey(other.callbacks_);\n                        var thisKey /** @type {!string} */ = util_1.getAnyKey(this.callbacks_);\n                        return (thisKey === otherKey &&\n                            (!other.callbacks_[otherKey] ||\n                                !this.callbacks_[thisKey] ||\n                                other.callbacks_[otherKey] === this.callbacks_[thisKey]));\n                    }\n                    else {\n                        // Exact match on each key.\n                        return util_1.every(this.callbacks_, function (eventType, cb) { return other.callbacks_[eventType] === cb; });\n                    }\n                }\n            }\n        }\n        return false;\n    };\n    /**\n     * @inheritDoc\n     */\n    ChildEventRegistration.prototype.hasAnyCallback = function () {\n        return this.callbacks_ !== null;\n    };\n    return ChildEventRegistration;\n}());\nexports.ChildEventRegistration = ChildEventRegistration;\n\n//# sourceMappingURL=EventRegistration.js.map\n"]}]