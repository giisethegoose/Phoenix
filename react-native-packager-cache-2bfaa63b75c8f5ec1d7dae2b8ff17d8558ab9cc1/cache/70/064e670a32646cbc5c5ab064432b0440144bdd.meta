["d2e292920b094ee748c9d2a0db708cd25f3482d0","6b3cc1c7ba799f9527df17b2d511dae18714fa7a",[],[],{"version":3,"sources":["/home/giise/candidtwo/node_modules/@firebase/storage/dist/cjs/src/implementation/backoff.js"],"names":["Object","defineProperty","exports","value","start","f","callback","timeout","waitSeconds","timeoutId","hitTimeout","cancelState","canceled","triggeredCallback","triggerCallback","apply","arguments","callWithDelay","millis","setTimeout","handler","success","var_args","_i","length","mustStop","waitMillis","Math","random","stopped","stop","wasTimeout","clearTimeout","id"],"mappings":"AAAA;;AAgBAA,OAAOC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C,EAAEC,OAAO,IAAT,EAA7C;;AAOA,SAASC,KAAT,CAAeC,CAAf,EAAkBC,QAAlB,EAA4BC,OAA5B,EAAqC;AAGjC,QAAIC,cAAc,CAAlB;;AAEA,QAAIC,YAAY,IAAhB;AACA,QAAIC,aAAa,KAAjB;AACA,QAAIC,cAAc,CAAlB;AACA,aAASC,QAAT,GAAoB;AAChB,eAAOD,gBAAgB,CAAvB;AACH;AACD,QAAIE,oBAAoB,KAAxB;AACA,aAASC,eAAT,GAA2B;AACvB,YAAI,CAACD,iBAAL,EAAwB;AACpBA,gCAAoB,IAApB;AACAP,qBAASS,KAAT,CAAe,IAAf,EAAqBC,SAArB;AACH;AACJ;AACD,aAASC,aAAT,CAAuBC,MAAvB,EAA+B;AAC3BT,oBAAYU,WAAW,YAAY;AAC/BV,wBAAY,IAAZ;AACAJ,cAAEe,OAAF,EAAWR,UAAX;AACH,SAHW,EAGTM,MAHS,CAAZ;AAIH;AACD,aAASE,OAAT,CAAiBC,OAAjB,EAA0B;AACtB,YAAIC,WAAW,EAAf;AACA,aAAK,IAAIC,KAAK,CAAd,EAAiBA,KAAKP,UAAUQ,MAAhC,EAAwCD,IAAxC,EAA8C;AAC1CD,qBAASC,KAAK,CAAd,IAAmBP,UAAUO,EAAV,CAAnB;AACH;AACD,YAAIV,iBAAJ,EAAuB;AACnB;AACH;AACD,YAAIQ,OAAJ,EAAa;AACTP,4BAAgBC,KAAhB,CAAsB,IAAtB,EAA4BC,SAA5B;AACA;AACH;AACD,YAAIS,WAAWb,cAAcF,UAA7B;AACA,YAAIe,QAAJ,EAAc;AACVX,4BAAgBC,KAAhB,CAAsB,IAAtB,EAA4BC,SAA5B;AACA;AACH;AACD,YAAIR,cAAc,EAAlB,EAAsB;AAElBA,2BAAe,CAAf;AACH;AACD,YAAIkB,UAAJ;AACA,YAAIf,gBAAgB,CAApB,EAAuB;AACnBA,0BAAc,CAAd;AACAe,yBAAa,CAAb;AACH,SAHD,MAIK;AACDA,yBAAa,CAAClB,cAAcmB,KAAKC,MAAL,EAAf,IAAgC,IAA7C;AACH;AACDX,sBAAcS,UAAd;AACH;AACD,QAAIG,UAAU,KAAd;AACA,aAASC,IAAT,CAAcC,UAAd,EAA0B;AACtB,YAAIF,OAAJ,EAAa;AACT;AACH;AACDA,kBAAU,IAAV;AACA,YAAIhB,iBAAJ,EAAuB;AACnB;AACH;AACD,YAAIJ,cAAc,IAAlB,EAAwB;AACpB,gBAAI,CAACsB,UAAL,EAAiB;AACbpB,8BAAc,CAAd;AACH;AACDqB,yBAAavB,SAAb;AACAQ,0BAAc,CAAd;AACH,SAND,MAOK;AACD,gBAAI,CAACc,UAAL,EAAiB;AACbpB,8BAAc,CAAd;AACH;AACJ;AACJ;AACDM,kBAAc,CAAd;AACAE,eAAW,YAAY;AACnBT,qBAAa,IAAb;AACAoB,aAAK,IAAL;AACH,KAHD,EAGGvB,OAHH;AAIA,WAAOuB,IAAP;AACH;AACD5B,QAAQE,KAAR,GAAgBA,KAAhB;;AAQA,SAAS0B,IAAT,CAAcG,EAAd,EAAkB;AACdA,OAAG,KAAH;AACH;AACD/B,QAAQ4B,IAAR,GAAeA,IAAf","sourcesContent":["\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * @param f May be invoked\n *     before the function returns.\n * @param callback Get all the arguments passed to the function\n *     passed to f, including the initial boolean.\n */\nfunction start(f, callback, timeout) {\n    // TODO(andysoto): make this code cleaner (probably refactor into an actual\n    // type instead of a bunch of functions with state shared in the closure)\n    var waitSeconds = 1;\n    // Would type this as \"number\" but that doesn't work for Node so ¯\\_(ツ)_/¯\n    var timeoutId = null;\n    var hitTimeout = false;\n    var cancelState = 0;\n    function canceled() {\n        return cancelState === 2;\n    }\n    var triggeredCallback = false;\n    function triggerCallback() {\n        if (!triggeredCallback) {\n            triggeredCallback = true;\n            callback.apply(null, arguments);\n        }\n    }\n    function callWithDelay(millis) {\n        timeoutId = setTimeout(function () {\n            timeoutId = null;\n            f(handler, canceled());\n        }, millis);\n    }\n    function handler(success) {\n        var var_args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            var_args[_i - 1] = arguments[_i];\n        }\n        if (triggeredCallback) {\n            return;\n        }\n        if (success) {\n            triggerCallback.apply(null, arguments);\n            return;\n        }\n        var mustStop = canceled() || hitTimeout;\n        if (mustStop) {\n            triggerCallback.apply(null, arguments);\n            return;\n        }\n        if (waitSeconds < 64) {\n            /* TODO(andysoto): don't back off so quickly if we know we're offline. */\n            waitSeconds *= 2;\n        }\n        var waitMillis;\n        if (cancelState === 1) {\n            cancelState = 2;\n            waitMillis = 0;\n        }\n        else {\n            waitMillis = (waitSeconds + Math.random()) * 1000;\n        }\n        callWithDelay(waitMillis);\n    }\n    var stopped = false;\n    function stop(wasTimeout) {\n        if (stopped) {\n            return;\n        }\n        stopped = true;\n        if (triggeredCallback) {\n            return;\n        }\n        if (timeoutId !== null) {\n            if (!wasTimeout) {\n                cancelState = 2;\n            }\n            clearTimeout(timeoutId);\n            callWithDelay(0);\n        }\n        else {\n            if (!wasTimeout) {\n                cancelState = 1;\n            }\n        }\n    }\n    callWithDelay(0);\n    setTimeout(function () {\n        hitTimeout = true;\n        stop(true);\n    }, timeout);\n    return stop;\n}\nexports.start = start;\n/**\n * Stops the retry loop from repeating.\n * If the function is currently \"in between\" retries, it is invoked immediately\n * with the second parameter as \"true\". Otherwise, it will be invoked once more\n * after the current invocation finishes iff the current invocation would have\n * triggered another retry.\n */\nfunction stop(id) {\n    id(false);\n}\nexports.stop = stop;\n\n//# sourceMappingURL=backoff.js.map\n"]}]