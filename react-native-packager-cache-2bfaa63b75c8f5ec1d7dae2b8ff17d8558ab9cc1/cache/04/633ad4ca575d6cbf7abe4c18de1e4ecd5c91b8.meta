["ca4394889b4eeb52e02c8b859e8e95d1fa8dfa5f","2cbb66b0a4b2c8432401057ce2ca14b3d10c0ea7",["@firebase/util","./Change"],[99,141,175],{"version":3,"sources":["/home/giise/candidtwo/node_modules/@firebase/database/dist/cjs/src/core/view/ChildChangeAccumulator.js"],"names":["Object","defineProperty","exports","value","util_1","require","Change_1","util_2","ChildChangeAccumulator","changeMap_","prototype","trackChildChange","change","type","childKey","childName","assert","Change","CHILD_ADDED","CHILD_CHANGED","CHILD_REMOVED","oldChange","safeGet","oldType","childChangedChange","snapshotNode","childRemovedChange","oldSnap","childAddedChange","assertionError","getChanges","getValues"],"mappings":"AAAA;;AAgBAA,OAAOC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C,EAAEC,OAAO,IAAT,EAA7C;AACA,IAAIC,SAASC,OAAT,kBAAJ;AACA,IAAIC,WAAWD,QAAQ,UAAR,CAAf;AACA,IAAIE,SAASF,OAAT,kBAAJ;;AAIA,IAAIG,yBAAwC,YAAY;AACpD,aAASA,sBAAT,GAAkC;AAC9B,aAAKC,UAAL,GAAkB,EAAlB;AACH;;AAIDD,2BAAuBE,SAAvB,CAAiCC,gBAAjC,GAAoD,UAAUC,MAAV,EAAkB;AAClE,YAAIC,OAAOD,OAAOC,IAAlB;AACA,YAAIC,WAAkCF,OAAOG,SAA7C;AACAR,eAAOS,MAAP,CAAcH,QAAQP,SAASW,MAAT,CAAgBC,WAAxB,IACVL,QAAQP,SAASW,MAAT,CAAgBE,aADd,IAEVN,QAAQP,SAASW,MAAT,CAAgBG,aAF5B,EAE2C,2CAF3C;AAGAb,eAAOS,MAAP,CAAcF,aAAa,WAA3B,EAAwC,iDAAxC;AACA,YAAIO,YAAYjB,OAAOkB,OAAP,CAAe,KAAKb,UAApB,EAAgCK,QAAhC,CAAhB;AACA,YAAIO,SAAJ,EAAe;AACX,gBAAIE,UAAUF,UAAUR,IAAxB;AACA,gBAAIA,QAAQP,SAASW,MAAT,CAAgBC,WAAxB,IAAuCK,WAAWjB,SAASW,MAAT,CAAgBG,aAAtE,EAAqF;AACjF,qBAAKX,UAAL,CAAgBK,QAAhB,IAA4BR,SAASW,MAAT,CAAgBO,kBAAhB,CAAmCV,QAAnC,EAA6CF,OAAOa,YAApD,EAAkEJ,UAAUI,YAA5E,CAA5B;AACH,aAFD,MAGK,IAAIZ,QAAQP,SAASW,MAAT,CAAgBG,aAAxB,IACLG,WAAWjB,SAASW,MAAT,CAAgBC,WAD1B,EACuC;AACxC,uBAAO,KAAKT,UAAL,CAAgBK,QAAhB,CAAP;AACH,aAHI,MAIA,IAAID,QAAQP,SAASW,MAAT,CAAgBG,aAAxB,IACLG,WAAWjB,SAASW,MAAT,CAAgBE,aAD1B,EACyC;AAC1C,qBAAKV,UAAL,CAAgBK,QAAhB,IAA4BR,SAASW,MAAT,CAAgBS,kBAAhB,CAAmCZ,QAAnC,EAA6CO,UAAUM,OAAvD,CAA5B;AACH,aAHI,MAIA,IAAId,QAAQP,SAASW,MAAT,CAAgBE,aAAxB,IACLI,WAAWjB,SAASW,MAAT,CAAgBC,WAD1B,EACuC;AACxC,qBAAKT,UAAL,CAAgBK,QAAhB,IAA4BR,SAASW,MAAT,CAAgBW,gBAAhB,CAAiCd,QAAjC,EAA2CF,OAAOa,YAAlD,CAA5B;AACH,aAHI,MAIA,IAAIZ,QAAQP,SAASW,MAAT,CAAgBE,aAAxB,IACLI,WAAWjB,SAASW,MAAT,CAAgBE,aAD1B,EACyC;AAC1C,qBAAKV,UAAL,CAAgBK,QAAhB,IAA4BR,SAASW,MAAT,CAAgBO,kBAAhB,CAAmCV,QAAnC,EAA6CF,OAAOa,YAApD,EAAkEJ,UAAUM,OAA5E,CAA5B;AACH,aAHI,MAIA;AACD,sBAAMpB,OAAOsB,cAAP,CAAsB,qCACxBjB,MADwB,GAExB,kBAFwB,GAGxBS,SAHE,CAAN;AAIH;AACJ,SA3BD,MA4BK;AACD,iBAAKZ,UAAL,CAAgBK,QAAhB,IAA4BF,MAA5B;AACH;AACJ,KAvCD;;AA2CAJ,2BAAuBE,SAAvB,CAAiCoB,UAAjC,GAA8C,YAAY;AACtD,eAAO1B,OAAO2B,SAAP,CAAiB,KAAKtB,UAAtB,CAAP;AACH,KAFD;AAGA,WAAOD,sBAAP;AACH,CAtD2C,EAA5C;AAuDAN,QAAQM,sBAAR,GAAiCA,sBAAjC","sourcesContent":["\"use strict\";\n/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar util_1 = require(\"@firebase/util\");\nvar Change_1 = require(\"./Change\");\nvar util_2 = require(\"@firebase/util\");\n/**\n * @constructor\n */\nvar ChildChangeAccumulator = /** @class */ (function () {\n    function ChildChangeAccumulator() {\n        this.changeMap_ = {};\n    }\n    /**\n     * @param {!Change} change\n     */\n    ChildChangeAccumulator.prototype.trackChildChange = function (change) {\n        var type = change.type;\n        var childKey /** @type {!string} */ = change.childName;\n        util_2.assert(type == Change_1.Change.CHILD_ADDED ||\n            type == Change_1.Change.CHILD_CHANGED ||\n            type == Change_1.Change.CHILD_REMOVED, 'Only child changes supported for tracking');\n        util_2.assert(childKey !== '.priority', 'Only non-priority child changes can be tracked.');\n        var oldChange = util_1.safeGet(this.changeMap_, childKey);\n        if (oldChange) {\n            var oldType = oldChange.type;\n            if (type == Change_1.Change.CHILD_ADDED && oldType == Change_1.Change.CHILD_REMOVED) {\n                this.changeMap_[childKey] = Change_1.Change.childChangedChange(childKey, change.snapshotNode, oldChange.snapshotNode);\n            }\n            else if (type == Change_1.Change.CHILD_REMOVED &&\n                oldType == Change_1.Change.CHILD_ADDED) {\n                delete this.changeMap_[childKey];\n            }\n            else if (type == Change_1.Change.CHILD_REMOVED &&\n                oldType == Change_1.Change.CHILD_CHANGED) {\n                this.changeMap_[childKey] = Change_1.Change.childRemovedChange(childKey, oldChange.oldSnap);\n            }\n            else if (type == Change_1.Change.CHILD_CHANGED &&\n                oldType == Change_1.Change.CHILD_ADDED) {\n                this.changeMap_[childKey] = Change_1.Change.childAddedChange(childKey, change.snapshotNode);\n            }\n            else if (type == Change_1.Change.CHILD_CHANGED &&\n                oldType == Change_1.Change.CHILD_CHANGED) {\n                this.changeMap_[childKey] = Change_1.Change.childChangedChange(childKey, change.snapshotNode, oldChange.oldSnap);\n            }\n            else {\n                throw util_2.assertionError('Illegal combination of changes: ' +\n                    change +\n                    ' occurred after ' +\n                    oldChange);\n            }\n        }\n        else {\n            this.changeMap_[childKey] = change;\n        }\n    };\n    /**\n     * @return {!Array.<!Change>}\n     */\n    ChildChangeAccumulator.prototype.getChanges = function () {\n        return util_1.getValues(this.changeMap_);\n    };\n    return ChildChangeAccumulator;\n}());\nexports.ChildChangeAccumulator = ChildChangeAccumulator;\n\n//# sourceMappingURL=ChildChangeAccumulator.js.map\n"]}]